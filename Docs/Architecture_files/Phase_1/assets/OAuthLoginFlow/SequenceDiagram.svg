<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="749px" preserveAspectRatio="none" style="width:1398px;height:749px;background:#FFFFFF;" version="1.1" viewBox="0 0 1398 749" width="1398px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="64.582" style="stroke:#000000;stroke-width:1.5;" width="1029.2744" x="362.7891" y="207.4941"/><rect fill="none" height="50.582" style="stroke:#000000;stroke-width:1.5;" width="644.4688" x="362.7891" y="348.6582"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="582.9473" width="8" x="18.7793" y="83.6211"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="22" x2="22" y1="83.6211" y2="666.5684"/></g><g><title>Spring Security</title><rect fill="#000000" fill-opacity="0.00000" height="582.9473" width="8" x="231.3745" y="83.6211"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="234.9092" x2="234.9092" y1="83.6211" y2="666.5684"/></g><g><title>OAuthAuthenticationSuccessHandler</title><rect fill="#000000" fill-opacity="0.00000" height="582.9473" width="8" x="490.9678" y="83.6211"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="494.7891" x2="494.7891" y1="83.6211" y2="666.5684"/></g><g><title>UserRepository</title><rect fill="#000000" fill-opacity="0.00000" height="582.9473" width="8" x="938.02" y="83.6211"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="941.7822" x2="941.7822" y1="83.6211" y2="666.5684"/></g><g><title>JwtEncoder</title><rect fill="#000000" fill-opacity="0.00000" height="582.9473" width="8" x="1046.8301" y="83.6211"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1050.2578" x2="1050.2578" y1="83.6211" y2="666.5684"/></g><g><title>UserViewMapper</title><rect fill="#000000" fill-opacity="0.00000" height="582.9473" width="8" x="1161.0884" y="83.6211"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1164.4023" x2="1164.4023" y1="83.6211" y2="666.5684"/></g><g><title>HttpServletResponse</title><rect fill="#000000" fill-opacity="0.00000" height="582.9473" width="8" x="1304.9189" y="83.6211"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1308.7744" x2="1308.7744" y1="83.6211" y2="666.5684"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.5586" x="5" y="80.1074">User</text><ellipse cx="22.7793" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22.7793,21.5 L22.7793,48.5 M9.7793,29.5 L35.7793,29.5 M22.7793,48.5 L9.7793,63.5 M22.7793,48.5 L35.7793,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.5586" x="5" y="680.6758">User</text><ellipse cx="22.7793" cy="692.6895" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22.7793,700.6895 L22.7793,727.6895 M9.7793,708.6895 L35.7793,708.6895 M22.7793,727.6895 L9.7793,742.6895 M22.7793,727.6895 L35.7793,742.6895" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Security"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.9307" x="180.9092" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.9307" x="187.9092" y="72.1074">Spring Security</text></g><g class="participant participant-tail" data-participant="Security"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.9307" x="180.9092" y="665.5684"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.9307" x="187.9092" y="687.6758">Spring Security</text></g><g class="participant participant-head" data-participant="Handler"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="244.3574" x="372.7891" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="230.3574" x="379.7891" y="72.1074">OAuthAuthenticationSuccessHandler</text></g><g class="participant participant-tail" data-participant="Handler"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="244.3574" x="372.7891" y="665.5684"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="230.3574" x="379.7891" y="687.6758">OAuthAuthenticationSuccessHandler</text></g><g class="participant participant-head" data-participant="Repo"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110.4756" x="886.7822" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.4756" x="893.7822" y="72.1074">UserRepository</text></g><g class="participant participant-tail" data-participant="Repo"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110.4756" x="886.7822" y="665.5684"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.4756" x="893.7822" y="687.6758">UserRepository</text></g><g class="participant participant-head" data-participant="Jwt"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.1445" x="1007.2578" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.1445" x="1014.2578" y="72.1074">JwtEncoder</text></g><g class="participant participant-tail" data-participant="Jwt"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.1445" x="1007.2578" y="665.5684"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.1445" x="1014.2578" y="687.6758">JwtEncoder</text></g><g class="participant participant-head" data-participant="Mapper"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121.3721" x="1104.4023" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.3721" x="1111.4023" y="72.1074">UserViewMapper</text></g><g class="participant participant-tail" data-participant="Mapper"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121.3721" x="1104.4023" y="665.5684"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.3721" x="1111.4023" y="687.6758">UserViewMapper</text></g><g class="participant participant-head" data-participant="Response"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146.2891" x="1235.7744" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.2891" x="1242.7744" y="72.1074">HttpServletResponse</text></g><g class="participant participant-tail" data-participant="Response"><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146.2891" x="1235.7744" y="665.5684"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.2891" x="1242.7744" y="687.6758">HttpServletResponse</text></g><g class="message" data-participant-1="User" data-participant-2="Security"><polygon fill="#181818" points="223.3745,112.9121,233.3745,116.9121,223.3745,120.9121,227.3745,116.9121" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="22.7793" x2="229.3745" y1="116.9121" y2="116.9121"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.5952" x="29.7793" y="111.6494">OAuth2 login (Facebook/GitHub)</text></g><g class="message" data-participant-1="Security" data-participant-2="Handler"><polygon fill="#181818" points="482.9678,144.2031,492.9678,148.2031,482.9678,152.2031,486.9678,148.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="235.3745" x2="488.9678" y1="148.2031" y2="148.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.5933" x="242.3745" y="142.9404">onAuthenticationSuccess(authentication)</text></g><g class="message" data-participant-1="Handler" data-participant-2="Handler"><line style="stroke:#181818;stroke-width:1;" x1="494.9678" x2="536.9678" y1="179.4941" y2="179.4941"/><line style="stroke:#181818;stroke-width:1;" x1="536.9678" x2="536.9678" y1="179.4941" y2="192.4941"/><line style="stroke:#181818;stroke-width:1;" x1="495.9678" x2="536.9678" y1="192.4941" y2="192.4941"/><polygon fill="#181818" points="505.9678,188.4941,495.9678,192.4941,505.9678,196.4941,501.9678,192.4941" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.6226" x="501.9678" y="174.2314">extract provider, email, name</text></g><path d="M362.7891,207.4941 L422.96,207.4941 L422.96,216.7852 L412.96,226.7852 L362.7891,226.7852 L362.7891,207.4941" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="64.582" style="stroke:#000000;stroke-width:1.5;" width="1029.2744" x="362.7891" y="207.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15.1709" x="377.7891" y="222.5225">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="125.3076" x="437.96" y="221.3643">[Missing email or name]</text><g class="message" data-participant-1="Handler" data-participant-2="Response"><polygon fill="#181818" points="1296.9189,246.0762,1306.9189,250.0762,1296.9189,254.0762,1300.9189,250.0762" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="494.9678" x2="1302.9189" y1="250.0762" y2="250.0762"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.2383" x="501.9678" y="244.8135">sendError(400, "Missing required user attributes")</text></g><g class="message" data-participant-1="Response" data-participant-2="Handler"><polygon fill="#181818" points="505.9678,260.0762,495.9678,264.0762,505.9678,268.0762,501.9678,264.0762" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="499.9678" x2="1307.9189" y1="264.0762" y2="264.0762"/></g><g class="message" data-participant-1="Handler" data-participant-2="Repo"><polygon fill="#181818" points="930.02,298.3672,940.02,302.3672,930.02,306.3672,934.02,302.3672" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="494.9678" x2="936.02" y1="302.3672" y2="302.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.0908" x="501.9678" y="297.1045">existsByUsername(email)</text></g><g class="message" data-participant-1="Repo" data-participant-2="Handler"><polygon fill="#181818" points="505.9678,329.6582,495.9678,333.6582,505.9678,337.6582,501.9678,333.6582" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="499.9678" x2="941.02" y1="333.6582" y2="333.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46.2681" x="511.9678" y="328.3955">boolean</text></g><path d="M362.7891,348.6582 L422.96,348.6582 L422.96,357.9492 L412.96,367.9492 L362.7891,367.9492 L362.7891,348.6582" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="50.582" style="stroke:#000000;stroke-width:1.5;" width="644.4688" x="362.7891" y="348.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15.1709" x="377.7891" y="363.6865">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="84.3154" x="437.96" y="362.5283">[user not found]</text><g class="message" data-participant-1="Handler" data-participant-2="Repo"><polygon fill="#181818" points="930.02,387.2402,940.02,391.2402,930.02,395.2402,934.02,391.2402" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="494.9678" x2="936.02" y1="391.2402" y2="391.2402"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="423.0522" x="501.9678" y="385.9775">save(new User{ username=email, name, iamProvider, defaultPassword })</text></g><g class="message" data-participant-1="Handler" data-participant-2="Repo"><polygon fill="#181818" points="930.02,425.5313,940.02,429.5313,930.02,433.5313,934.02,429.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="494.9678" x2="936.02" y1="429.5313" y2="429.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.8208" x="501.9678" y="424.2686">findByUsername(email)</text></g><g class="message" data-participant-1="Repo" data-participant-2="Handler"><polygon fill="#181818" points="505.9678,456.8223,495.9678,460.8223,505.9678,464.8223,501.9678,460.8223" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="499.9678" x2="941.02" y1="460.8223" y2="460.8223"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.4473" x="511.9678" y="455.5596">User</text></g><g class="message" data-participant-1="Handler" data-participant-2="Security"><polygon fill="#181818" points="246.3745,488.1133,236.3745,492.1133,246.3745,496.1133,242.3745,492.1133" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="240.3745" x2="493.9678" y1="492.1133" y2="492.1133"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.5972" x="252.3745" y="486.8506">getAuthorities() (roles)</text></g><g class="message" data-participant-1="Handler" data-participant-2="Jwt"><polygon fill="#181818" points="1038.8301,519.4043,1048.8301,523.4043,1038.8301,527.4043,1042.8301,523.4043" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="494.9678" x2="1044.8301" y1="523.4043" y2="523.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="453.1021" x="501.9678" y="518.1416">encode(claims: issuer="example.io", subject="id,username", roles, exp=3600s)</text></g><g class="message" data-participant-1="Jwt" data-participant-2="Handler"><polygon fill="#181818" points="505.9678,550.6953,495.9678,554.6953,505.9678,558.6953,501.9678,554.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="499.9678" x2="1049.8301" y1="554.6953" y2="554.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.8018" x="511.9678" y="549.4326">token</text></g><g class="message" data-participant-1="Handler" data-participant-2="Mapper"><polygon fill="#181818" points="1153.0884,581.9863,1163.0884,585.9863,1153.0884,589.9863,1157.0884,585.9863" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="494.9678" x2="1159.0884" y1="585.9863" y2="585.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.4136" x="501.9678" y="580.7236">toUserView(user)</text></g><g class="message" data-participant-1="Mapper" data-participant-2="Handler"><polygon fill="#181818" points="505.9678,613.2773,495.9678,617.2773,505.9678,621.2773,501.9678,617.2773" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="499.9678" x2="1164.0884" y1="617.2773" y2="617.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.6245" x="511.9678" y="612.0146">UserView</text></g><g class="message" data-participant-1="Handler" data-participant-2="Response"><polygon fill="#181818" points="1296.9189,644.5684,1306.9189,648.5684,1296.9189,652.5684,1300.9189,648.5684" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="494.9678" x2="1302.9189" y1="648.5684" y2="648.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260.1016" x="501.9678" y="643.3057">write JSON { token, id, userName, fullName }</text></g><!--SRC=[ZLDDQnin4BthLmnxseLDQzhIGy255jAQG3w8QU_oxjYTHfPKQMGdXFptZhHhuqrQw6518yrxyzxChExO1VWUCIZbTM3go6lBK2rz8Bk19NOf43zMeECnc6RUV4xyCtzevL8pERjCNOSnBhJj3OQ27SzJQAvxXzv54XL3ZHnEaoxtV64xruz44huc-K6ulzBUZpd3SPgsOFPB33k3V8VHEnjnB3W4IcKYEFjqj0ddKBoz0-CsPA7-gZjSENV_zXln8gqQTSmKr6XGGCx-jHkrdjmsIXqW4pG-SD0TWmzkHsAw1TngCYrOlKMb3SCLnPXdK-v1nbTU04xe3gQ4BwBjBq9meVumcxLG7T01VoSAs4FAjZLpe5LYZ5KZL04v1Qi4Eb6PXrCaKkJuvJ4tBDUkYv96bUUpYHjfbq5jY-vIo3g6jKj2_49mOOvwXxN5VTd8fuB81UOdBMY1zFRss9mUrpePljKnxbteuRdvb-ersVw_D0z_mmd1oK9iaFDmdOI4iMwW3c8mDgVfig6vIMLdwyvesiPpaAud3FCA7_JM6tn3hceXfjKlx7XUKTyUlCfrePIvF_Zv-u-pcR1dogb8TlTe9og7fIzFXr-YpgID6bzUkymvBrfrt9kzM4IuNDvSmzDGJJhVjsKcrsKEwsHCFi7p7m00]--></g></svg>